# 幂等性

**幂等性**

任意多次执行所产生的影响与一次执行相同。



**幂等性场景**：需要考虑幂等性的场景一般是多次请求的地方，有如下场景：

1、前端重复提交。

2、接口超时重试。提供给第三方的接口，一般会考虑网络原因，需要提供重试机制。

3、消息重复消费。MQ消息中间件。



**幂等性实现方式**

**token机制**：解决用户端重复提交的问题

1、存在幂等性的业务，在提交前需要先获取token。服务器生成token，然后token存储在redis。

2、client调用服务器业务接口的时候，需要在header中设置token。

3、服务器端判断token是否存在，存在标识第一次请求，执行对应的业务逻辑，逻辑执行完了删除redis中对应的token。

4、token不存在表示是重复请求，直接返回客户端重复请求。



**状态机**：业务流转会有对应的状态码

业务请求时，对应的状态码必须是指定的值，如：代付款。



**数据库表去重**





**redis去重**

